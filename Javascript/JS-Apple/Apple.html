<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://kit.fontawesome.com/160bae148b.js" crossorigin="anonymous"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
  <link rel="Shortcut Icon" type="image/x-icon" href="Img/apple.png" />
  <title>I have an apple!</title>
  <style>
    .navbar-brand {
      margin: auto 10%;
      font-size: 24px;
    }

    .navbar-nav {
      width: 56%;
    }

    .nav-item {
      margin: auto 10%;
    }

    .nav-item a:hover {
      transform: scale(1.2);
      transition: .3s;
    }

    .navbar-toggler {
      background-color: rgb(202, 202, 202) !important;
    }

    .service {
      font-size: 14px;
    }

    .service i {
      font-size: 21px;
    }

    .color,
    .storage_Ram_Network {
      border-bottom: 1px rgb(211, 211, 211) solid;
    }

    .colorBtn,
    .storageBtn{
      background-color: white;
      width: 30%;
      height: 90px;
      border: 1px solid silver;
      border-radius: 5%;
    }

    .networkBtn,.ramBtn,.mac_storageBtn {
      background-color: white;
      width: 40%;
      height: 90px;
      border: 1px solid silver;
      border-radius: 5%;
    }
    .ramBtn,.mac_storageBtn{
      height: 70px;
    }

    .colorBtn:hover,
    .networkBtn:hover,
    .storageBtn:hover,
    .ramBtn:hover, 
    .mac_storageBtn:hover {
      transform: scale(1.05);
      transition: .4s; 
      transition-property: transform; 
      /* 延遲只作用在哪個樣式項目上 */
      background-color: rgb(255, 255, 244);
    }

    .ramBtn:hover p, 
    .mac_storageBtn:hover p{
      font-weight: bolder;
    }

    .active {
      border: 3px solid rgb(143, 195, 255);
    }
    .ramBtn.active, 
    .mac_storageBtn.active{
      font-weight: bolder;
    }

    .colorBtn p:last-child,
    .networkBtn p:last-child,
    .storageBtn p:last-child{
      font-size: 13px;
      color: gray;
    }

    .storageBtn p:first-child{
      font-size: 1.25rem;
    }

    .networkBtn p:first-child,
    .mac_storageBtn:first-child  {
      font-size: 1rem;
    }

    /* 平板 */
    @media screen and (max-width: 1024px) {
      .networkBtn,.ramBtn,.mac_storageBtn{
        width: 65%;
        height: 70px;
      }
      .colorBtn,.storageBtn{
        width: 42%;
        }

    }

    @media screen and (max-width: 767px) {
      .navbar-brand {
        margin: auto 7%;
      }
      .networkBtn {
      width: 45%;
      }
      .colorBtn,.storageBtn{
        width: 45%;
        }
    }
  </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand text-white" href="#"><img src="" alt=""><i class="fab fa-apple"></i></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse " id="navbarSupportedContent">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link  text-white" href="#" data-bs-toggle="collapse" data-bs-target=".navbar-collapse.show">iPhone</a>
          </li>
          <li class="nav-item">
            <a class="nav-link  text-white" href="#" data-bs-toggle="collapse" data-bs-target=".navbar-collapse.show">iPad</a>
          </li>
          <li class="nav-item">
            <a class="nav-link  text-white" href="#" data-bs-toggle="collapse" data-bs-target=".navbar-collapse.show">Mac</a>
          </li>
          <li class="nav-item">
            <a class="nav-link  text-white" href="#" data-bs-toggle="modal" data-bs-target="#modal_search_shop_btn"><i class="fas fa-search"></i></a>
          </li>
          <li class="nav-item">
            <a class="nav-link  text-white" href="#" data-bs-toggle="modal" data-bs-target="#modal_search_shop_btn"><i class="fas fa-cart-plus"></i></a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container">
    <div class="row">
      <div class="col-12 col-md-6">
        <div class="productImg d-grid">
          <img src="Img/iphone11-白.png" class="product_img mx-auto w-75">
        </div>
        <div class="row mt-5 px-5 service">
          <div class="col-6 text-center py-2">
            <i class="fas fa-plane mb-2"></i>
            <p>快速且免額外付費的運送服務</p>
          </div>
          <div class="col-6 text-center py-2">
            <i class="fas fa-box-open mb-2"></i>
            <p>免額外付費輕鬆退貨</p>
          </div>
          <div class="col-12 d-flex align-items-center justify-content-center border-top p-3">
            <div class="mx-3">
              <i class="far fa-comment-dots"></i>
            </div>
            <div>
              <p class="m-0">有任何購買上的問題嗎？</p>
              <a href="#">與apple專員線上對談^^</a>
            </div>
          </div>
        </div>
      </div>

      <div class="col-12 col-md-6 p-4 ">
        <h3 class="fw-bolder mt-2 mb-4">購買iphone11</h3>

        <div class="color">
          <h5 class="fw-bolder">外觀</h5>
          <div class="d-flex flex-wrap my-2 colorBtnsBox">
            <!-- 放colorBtnTemplate -->
          </div>
        </div>
        <div class="storage_Ram_Network_Box">
          <!-- 放storage_Ram_Network_Template-->
        </div>

        <div class="price mt-4">
          <h5 class="fw-bolder d-inline my-auto ">價格試算</h5> <span class="m-3 text-dark fw-bolder fs-2"></span>
        </div>

      </div>
    </div>
  </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="modal_search_shop_btn" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel"></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body"></div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary " data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <template id="colorBtnTemplate">
    <button class="m-2 colorBtn">
      <img class="my-1 w-25" src="Img/iphone11-紫.jfif">
      <p class="m-0">紫色</p>
    </button>
  </template>

  <!-- 容量storageBtn 連線能力networkBtn 記憶體ramBtn用同個模板 含選擇title-->
  <template id="storage_Ram_Network_Template">
    <div class="storage_Ram_Network mt-3">
      <h5 class="fw-bolder"></h5>
      <div class="d-flex flex-wrap my-2 btnsBox">
        <!-- 放button模板 -->
      </div>
    </div>
  </template>

<!--button模板 按鈕記得加上不同class: storageBtn ramBtn networkBtn -->
  <template id="btnsTemplate">
    <button class="m-2">  
      <p class="my-1 text-dark fw-bolder"></p>
      <p class="m-0"></p>
    </button>
  </template>

  <script>
    //設定選項的陣列 依不同產品所需的
    let products = {
      iphone: {
        color: ["白色", "黑色", "綠色", "黃色", "紫色", "紅色"],
        img_color: ["Img/iphone11-白.jfif", "Img/iphone11-黑.jfif", "Img/iphone11-綠.jfif", "Img/iphone11-黃.jfif", "Img/iphone11-紫.jfif", "Img/iphone11-紅.jfif"],
        img: ["Img/iphone11-白.png", "Img/iphone11-黑.png", "Img/iphone11-綠.png", "Img/iphone11-黃.png", "Img/iphone11-紫.png", "Img/iphone11-紅.png"],
        storage: ["64GB", "128GB", "256GB"],
        price: ["19900", "21500", "25000"]
      },
      ipad: {
        color: ["太空灰色", "銀色", "玫瑰金", "綠色", "天藍色"],
        img_color: ["Img/ipadAir-color灰.png", "Img/ipadAir-color銀.png", "Img/ipadAir-color金.jfif", "Img/ipadAir-color綠.jfif", "Img/ipadAir-color藍.png"],
        img: ["Img/ipadAir-灰2.png", "Img/ipadAir-銀2.png", "Img/ipadAir-金2.png", "Img/ipadAir-綠2.png", "Img/ipadAir-藍2.png"],
        storage: ["64GB", "256GB"],
        storage_basicPrice: ["18900","23900"], //64:18900 256:23900
        network: ["Wi-Fi", "Wi-Fi + 行動網路"],
        price_network: ["18900","23200","23900","28200"],//64g wifi:18900,64g cellular:23200, 256g wifi:23900,256g cellular:28200,
      },
      mac: {
        color: ["太空灰色", "銀色"],
        img_color: ["Img/ipadAir-color灰.png", "Img/ipadAir-color銀.png"],
        img: ["Img/macPro-13-灰2.0.jfif", "Img/macPro-13-銀2.0.jfif"],
        ram: ["8GB", "16GB"],
        storage: ["256GB", "512GB", "1TB","2TB"], 
        price: ["39900", "45900", "51900","63900","45900", "51900", "57900","69900"]
      }
    }
    //預設為哀鳳頁面
    window.onload = function(){
      setIphonePage();
      changeModalContent();
    } 

    //按蘋果icon重新載入=回到預設頁面
    document.querySelector(".navbar-brand").addEventListener('click', function () { window.location.reload(); })

    document.querySelectorAll(".navbar-nav a")[0].addEventListener('click',setIphonePage)
    document.querySelectorAll(".navbar-nav a")[1].addEventListener('click',setIpadPage)  
    document.querySelectorAll(".navbar-nav a")[2].addEventListener('click',setMacPage)   

    let price=document.querySelector(".price span");

    function setIphonePage() {
      generateColor(products.iphone)
      setDefaultPage("iPhone11")
      generateStorage("iphone");
    }

    function setIpadPage() {
      generateColor(products.ipad)
      setDefaultPage("iPad Air")
      generateStorage("ipad");
      generateNetwork();
    }

    function setMacPage() {
      generateColor(products.mac)
      setDefaultPage("MacBook Pro")
      generateRam_Storage("ram")
      generateRam_Storage("storage")
    }

    function setDefaultPage(productTitle) {
      document.getElementsByTagName("h3")[0].innerText = `購買${productTitle}`;
      document.querySelectorAll(".colorBtn")[0].click(); //點任何商品頁面後 照片先跑以第一個顏色為預設 不然商品會維持上一個等到按顏色才變
      document.getElementsByClassName("storage_Ram_Network_Box")[0].innerText = "";
      price.innerText = "";
    }

    function removeButtonActiveClass(btnsCollection) {
      btnsCollection.forEach((btn, index) => {
        btn.classList.remove("active");
      })
    }

    function generateColor(productObj) {
      document.getElementsByClassName("colorBtnsBox")[0].innerHTML = ""; //避免重複按重複生按鈕
      let color_btn = document.querySelector('#colorBtnTemplate');
      (productObj.color).forEach((color, index) => {
        let cloneContent = color_btn.content.cloneNode(true);
        cloneContent.querySelector('p').innerText = color;
        cloneContent.querySelector('img').src = (productObj.img_color)[index];
        document.getElementsByClassName("colorBtnsBox")[0].append(cloneContent);
      })
      let colorBtns = document.querySelectorAll(".colorBtn");
      colorBtns.forEach((btn, index) => {
        btn.addEventListener('click', function () {
          removeButtonActiveClass(colorBtns); //在加上新點的按鈕的active前 先移掉同個系列的按鈕的active 
          btn.classList.add("active");
          document.querySelector(".productImg img").src = (productObj.img)[index]
        })
      })

    }

    //iphone ipad共用產生storage
    function generateStorage(currentProduct) {
      let selectionBox = document.querySelector('#storage_Ram_Network_Template').content.cloneNode(true);
      selectionBox.querySelector(".btnsBox").innerText = ""; //避免重複按重複生按鈕
      selectionBox.querySelector("h5").innerText = "儲存容量";
      
        (products[currentProduct].storage).forEach((item, index) => {
          let buttonContent = document.querySelector('#btnsTemplate').content.cloneNode(true);
          buttonContent.querySelector("button").classList.add("storageBtn");
          buttonContent.querySelector(".storageBtn p:first-child").innerText = item;
          
          if (currentProduct == "iphone") 
            buttonContent.querySelector(".storageBtn p:last-child").innerText = `NT$${products[currentProduct].price[index]}`;
          else{
            buttonContent.querySelector(".storageBtn p:last-child").innerText = `NT$${products[currentProduct].storage_basicPrice[index]}起`;
          }
          selectionBox.querySelector(".btnsBox").append(buttonContent);
        })
          document.getElementsByClassName("storage_Ram_Network_Box")[0].append(selectionBox);
          let storageBtns = document.querySelectorAll(".storageBtn");
          storageBtns.forEach((btn, index) => {
              
              btn.addEventListener('click', function () {
              removeButtonActiveClass(storageBtns); //在加上新點的按鈕的active前 先移掉同個系列的按鈕的active 
              btn.classList.add("active");
              
              if (currentProduct == "iphone") price.innerText = `NT$${products[currentProduct].price[index]}`
              else if (currentProduct == "ipad") {
                let currentStorage = btn.querySelector("p:first-child").innerText;
                updatePrice_ipad(currentProduct, currentStorage)
              }
              else{
                price.innerText = `NT$${products[currentProduct].storage_basicPrice[index]}`
              }            
          })
        })
      }

      //只有Ipad有network
      function generateNetwork(){
        let selectionBox = document.querySelector('#storage_Ram_Network_Template').content.cloneNode(true);
        selectionBox.querySelector(".btnsBox").innerText = ""; //避免重複按重複生按鈕
        selectionBox.querySelector("h5").innerText = "連線能力";
        products.ipad.network.forEach((item, index) => {
          let buttonContent = document.querySelector('#btnsTemplate').content.cloneNode(true);
          buttonContent.querySelector("button").classList.add("networkBtn");
          buttonContent.querySelector(".networkBtn p:first-child").innerText = item;
          selectionBox.querySelector(".btnsBox").append(buttonContent);
        })
          document.getElementsByClassName("storage_Ram_Network_Box")[0].append(selectionBox);

          let networkBtns = document.querySelectorAll(".networkBtn");
          networkBtns.forEach((btn, index) => {
              btn.addEventListener('click', function () {
              removeButtonActiveClass(networkBtns); //在加上新點的按鈕的active前 先移掉同個系列的按鈕的active 
              btn.classList.add("active");
              price.innerText = `${btn.querySelector("p:last-child").innerText}`;
          })}
        )}

      function updatePrice_ipad(currentProduct, currentStorage) {
        let storageIndex = products[currentProduct].storage.indexOf(currentStorage);
        let networkBtns = document.querySelectorAll(".networkBtn");
        let networkIndex = storageIndex * 2;
        networkBtns.forEach((btn, index)=> {
          btn.querySelector("p:last-child").innerText = `NT$${products[currentProduct].price_network[networkIndex]}`;
          if (btn.classList.contains("active")) {
            price.innerText = btn.querySelector("p:last-child").innerText;
          }
          networkIndex++;
        })
      }

      //Mac專用設定ram storage
      function generateRam_Storage(selectionItem){
        let selectionBox = document.querySelector('#storage_Ram_Network_Template').content.cloneNode(true);
        selectionBox.querySelector(".btnsBox").innerText = ""; //避免重複按重複生按鈕
        if(selectionItem=="ram")selectionBox.querySelector("h5").innerText = "記憶體";
        else{
          selectionBox.querySelector("h5").innerText = "儲存裝置"
        }
      
        (products.mac[selectionItem]).forEach((item, index) => {
          let buttonContent = document.querySelector('#btnsTemplate').content.cloneNode(true);
          buttonContent.querySelector("p:first-child").classList.remove("fw-bolder");

          if(selectionItem=="ram"){
            buttonContent.querySelector("button").classList.add("ramBtn");
            buttonContent.querySelector("p:first-child").innerText = `${item} 統一記憶體`;
          }
          else{
            buttonContent.querySelector("button").classList.add("mac_storageBtn");
            buttonContent.querySelector("p:first-child").innerText = `${item} SSD 儲存裝置`;
          }        
          buttonContent.querySelector("button").removeChild(buttonContent.querySelector("p:last-child"))
          selectionBox.querySelector(".btnsBox").append(buttonContent);        
        })

        document.getElementsByClassName("storage_Ram_Network_Box")[0].append(selectionBox);
        macBtn_set_active(".ramBtn");
        macBtn_set_active(".mac_storageBtn");
      }
      
      let ram_index;
      let storage_index;

      function macBtn_set_active(btn_className){
        
        let Btns = document.querySelectorAll(btn_className);
          Btns.forEach((btn, index) => {
              btn.addEventListener('click', function () {
              removeButtonActiveClass(Btns); //在加上新點的按鈕的active前 先移掉同個系列的按鈕的active 
              btn.classList.add("active");
              if(btn.classList.contains("ramBtn")) {
                ram_index=index;

              }
              
              else{
                storage_index=index;
              }
              console.log(ram_index);
              console.log(storage_index);
              mac_findPrice(ram_index,storage_index)
            })
          })
      }

      function mac_findPrice(ram_index,storage_index){
        let price_index= (products.mac.storage).length*ram_index+storage_index;
        if (storage_index != undefined && ram_index != undefined) price.innerText=`NT$${products.mac.price[price_index]}`;
      }

      function changeModalContent(){
        document.querySelectorAll(".navbar-nav a")[3].addEventListener('click',function(){
        document.querySelector("#modal_search_shop_btn .modal-title").innerText="想找什麼嗎?";
        document.querySelector("#modal_search_shop_btn .modal-body").innerText="請到真正官網找。";
      })
        document.querySelectorAll(".navbar-nav a")[4].addEventListener('click',function(){
        document.querySelector("#modal_search_shop_btn .modal-title").innerText="看到喜歡的小蘋果了嗎?";
        document.querySelector("#modal_search_shop_btn .modal-body").innerText="順便買一支給我^^";
      })
      }



  </script>



  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
    crossorigin="anonymous"></script>

</body>

</html>