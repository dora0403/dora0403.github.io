<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/160bae148b.js" crossorigin="anonymous"></script>

    <title>Hello, Slot!</title>
    <style>
        i{
            font-size: 48px ;
        }
        [box-id]{
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: none;
            transition: 0.3s;
        }
        [box-id].active {
            border: 5px solid rgb(255, 47, 47);
            box-shadow: 0 0 20px violet;
            transition: 0s;
        }

        #msg{
            font-size: 36px;
            text-align: center;
          
        }

    </style>
  </head>
  <body>
      <div class="container">
          <div class="row">
          <div box-id="1" class="col-1"></div>
          <div box-id="2" class="col-1"></div>
          <div box-id="3" class="col-1"></div>
          <div box-id="4" class="col-1"></div>
          <div box-id="5" class="col-1"></div>
          <div box-id="6" class="col-1"></div>
          <div box-id="7" class="col-1"></div>
          <div box-id="8" class="col-1"></div>
          <div box-id="9" class="col-1"></div>
          <div box-id="10" class="col-1"></div>
          <div box-id="11" class="col-1"></div>
          <div box-id="12" class="col-1"></div>
        </div>
          <div class="row">
              <div box-id="32"  class="col-1"></div>
              <div class="col-10 m-auto">
                <p id="msg" class="m-0"></p>
            </div>
              <div box-id="13" class="col-1"></div>
            </div>
          <div class="row">
          <div box-id="31" class="col-1"></div>
          <div class="col-10 m-auto">
              <p id="msg" class="m-0"></p>
          </div>
          <div box-id="14" class="col-1"></div>
         </div>
          <div class="row">
            <div box-id="30" class="col-1"></div>
            <div class="col-10 d-grid m-auto">
                <button class="btn btn-primary m-auto" >GO</button>
            </div>
            <div box-id="15" class="col-1"></div>
        </div>
          <div class="row">
            <div box-id="29" class="col-1"></div>
            <div class="col-10 m-auto">
                <p id="msg" class="m-0"></p>
            </div>
            <div box-id="16" class="col-1"></div>
        </div>

          <div class="row">
            <div box-id="28" class="col-1"></div>
            <div box-id="27" class="col-1"></div>
            <div box-id="26" class="col-1"></div>
            <div box-id="25" class="col-1"></div>
            <div box-id="24" class="col-1"></div>
            <div box-id="23" class="col-1"></div>
            <div box-id="22" class="col-1"></div>
            <div box-id="21" class="col-1"></div>
            <div box-id="20" class="col-1"></div>
            <div box-id="19" class="col-1"></div>
            <div box-id="18" class="col-1"></div>
            <div box-id="17" class="col-1"></div>
          </div>
      </div>

      <script>
          let steps=0; //剩下要走的步數
          let allSteps=0; 
          let currentIndex = 0; //目前走到哪個
          let speed; //速率(越大越慢)

          let brickData=[
              {
                  id:"1",
                  color:"violet",
                  icon:"fab fa-instagram-square",
                  target: function(){
                      return this.icon.split('-')[1];
                  }
              },
              {
                  id:"2",
                  color:"skyblue",
                  icon:"fab fa-facebook-square",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"3",
                  color:"lightgreen",
                  icon:"fab fa-line",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"4",
                  color:"violet",
                  icon:"fab fa-instagram-square",
                  target: function(){
                      return this.icon.split('-')[1];
                  }
              },
              {
                  id:"5",
                  color:"skyblue",
                  icon:"fab fa-facebook-square",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"6",
                  color:"lightgreen",
                  icon:"fab fa-line",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"7",
                  color:"violet",
                  icon:"fab fa-instagram-square",
                  target: function(){
                      return this.icon.split('-')[1];
                  }
              },
              {
                  id:"8",
                  color:"skyblue",
                  icon:"fab fa-facebook-square",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"9",
                  color:"lightgreen",
                  icon:"fab fa-line",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"10",
                  color:"violet",
                  icon:"fab fa-instagram-square",
                  target: function(){
                      return this.icon.split('-')[1];
                  }
              },
              {
                  id:"11",
                  color:"skyblue",
                  icon:"fab fa-facebook-square",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"12",
                  color:"lightgreen",
                  icon:"fab fa-line",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"13",
                  color:"violet",
                  icon:"fab fa-instagram-square",
                  target: function(){
                      return this.icon.split('-')[1];
                  }
              },
              {
                  id:"14",
                  color:"skyblue",
                  icon:"fab fa-facebook-square",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"15",
                  color:"lightgreen",
                  icon:"fab fa-line",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"16",
                  color:"violet",
                  icon:"fab fa-instagram-square",
                  target: function(){
                      return this.icon.split('-')[1];
                  }
              },
              {
                  id:"17",
                  color:"skyblue",
                  icon:"fab fa-facebook-square",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"18",
                  color:"lightgreen",
                  icon:"fab fa-line",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"19",
                  color:"violet",
                  icon:"fab fa-instagram-square",
                  target: function(){
                      return this.icon.split('-')[1];
                  }
              },
              {
                  id:"20",
                  color:"skyblue",
                  icon:"fab fa-facebook-square",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"21",
                  color:"lightgreen",
                  icon:"fab fa-line",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"22",
                  color:"violet",
                  icon:"fab fa-instagram-square",
                  target: function(){
                      return this.icon.split('-')[1];
                  }
              },
              {
                  id:"23",
                  color:"skyblue",
                  icon:"fab fa-facebook-square",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"24",
                  color:"lightgreen",
                  icon:"fab fa-line",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"25",
                  color:"violet",
                  icon:"fab fa-instagram-square",
                  target: function(){
                      return this.icon.split('-')[1];
                  }
              },
              {
                  id:"26",
                  color:"skyblue",
                  icon:"fab fa-facebook-square",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"27",
                  color:"lightgreen",
                  icon:"fab fa-line",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"28",
                  color:"violet",
                  icon:"fab fa-instagram-square",
                  target: function(){
                      return this.icon.split('-')[1];
                  }
              },
              {
                  id:"29",
                  color:"skyblue",
                  icon:"fab fa-facebook-square",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"30",
                  color:"lightgreen",
                  icon:"fab fa-line",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"31",
                  color:"violet",
                  icon:"fab fa-instagram-square",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              },
              {
                  id:"32",
                  color:"skyblue",
                  icon:"fab fa-facebook-square",
                  target: function(){
                    return this.icon.split('-')[1];
                  }
              }
          ]
      //渲染畫面
      let bricks = document.querySelectorAll("[box-id]");
      bricks=Array.from(bricks).sort(
          (a,b)=>{
              return a.getAttributeNode("box-id").value-b.getAttributeNode("box-id").value;
          })
        
    bricks.forEach((x,index) => {
        let id = index+1;
        let data = brickData.find(x=>x.id==id)
        let icon = document.createElement("i");
        icon.setAttribute("class",data.icon);
        icon.style.color=data.color;
        x.appendChild(icon);
    })

    //按下start
    document.querySelector("button").addEventListener('click',function(){
        speed = 50;
        let random = Math.floor(Math.random()*brickData.length)+1;
        steps=random+(2*bricks.length); //當跑剩1/2時開始減速
        allSteps=steps;
        turnAround();
    })
    function turnAround(){
        bricks[currentIndex].classList.remove('active');
        currentIndex++;
        if(currentIndex>=bricks.length) currentIndex=0;
        bricks[currentIndex].classList.add('active');
        steps--;

        // //一般
        // if(steps>0){
        //     setTimeout(turnAround,speed);
        // }
        // else{
        //     //跑完ㄌ
        //     let msgBox =document.getElementById('msg');
        //     let val =brickData[currentIndex].target();
        //     msgBox.innerText=`接下來>>>${val}`;
        // }
        //加速版
        if(steps>0){
            setTimeout(turnAround,speed);
            if(steps<Math.floor(allSteps/3)) speed+=7
        }
        else{
            //跑完ㄌ
            let msgBox =document.getElementById('msg');
            let val =brickData[currentIndex].target();
            msgBox.innerText=`接下來>>>${val}`;
        }
    }

      
      
      </script>





    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>

  </body>
</html>